<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
<script src="https://code.highcharts.com/modules/accessibility.js"></script>
<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
<link rel="stylesheet" href="assets/css/materialdesignicons.min.css">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<head>

    <%- include('../../head/head-report.ejs') -%>

        </nav>
<div class="layout-datetime" style="background: url(/static/images/img-map/3.jpg);background-size: cover !important;">
    <div class="title-datetime">
        <div class="date-time">
            <label style="font-size: 24px;">Thời gian bắt đầu:<span style="margin-left:5px"><%= start_date %> </span></label>
            -
            <label style="font-size: 24px;">Thời gian kết thúc:<span style="margin-left:5px"><%= end_date %></span></label>
        </div>
    
    </div>
    <div class="layout-time-column" >
        <div class="col-md-12">
            <div class="row">
                <div class="col-md-6">
                    <!-- <div class="export-excel">
                        <button class="btn btn-success" onclick="tablesToExcelMultiTabs(['LVMSB1'], ['LVMSB1'], '', 'Excel')"><i class="fa fa-file-excel-o" style="margin-right:5px"></i>Xuất Excel</button>
                    </div> -->
                    <figure class="highcharts-figure">
                        <div id="powerHour87">
                            </div> 
                    </figure>
                 
                </div>
                <div class="col-md-6">
                    <!-- <div class="export-excel">
                        <button class="btn btn-success" onclick="tablesToExcelMultiTabs(['LVMSB2'], ['LVMSB2'], '', 'Excel')"><i class="fa fa-file-excel-o" style="margin-right:5px"></i>Xuất Excel</button>
                    </div> -->
                    <figure class="highcharts-figure">
                        <div id="powerHour972">
                            </div>
                    </figure>
               
                </div>
                <div class="col-md-6">
                    <!-- <div class="export-excel">
                        <button class="btn btn-success" onclick="tablesToExcelMultiTabs(['LVMSB3'], ['LVMSB3'], '', 'Excel')"><i class="fa fa-file-excel-o" style="margin-right:5px"></i>Xuất Excel</button>
                    </div> -->
                    <figure class="highcharts-figure">
                        <div id="powerHourDh">
                            </div>
                    </figure>
                  
                   
                </div>
                <div class="col-md-6">
                    <!-- <div class="export-excel" style="visibility: hidden;">
                        <button class="btn btn-success" onclick="tablesToExcelMultiTabs(['LVMSB3'], ['LVMSB3'], '', 'Excel')"><i class="fa fa-file-excel-o" style="margin-right:5px"></i>Xuất Excel</button>
                    </div> -->
                    <figure class="highcharts-figure">
                        <div id="powerSum">
                            </div>
                    </figure>
                </div>
                <div class="data-table" id="LVMSB1" data-SheetName="LVMSB1" style="display:none">
                    <table style="border:0;" cellpadding="10" cellspacing="10">
                        <tr>
                            <td colspan="2" align="center">
                                <p style="font-size:18px"><b>Sumirubber Vietnam</b></p>
                                <p> -----------o0o------------</p>
                            </td>
                            <td colspan="2" align="center">
                                <p style="font-size:18px"><b>CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM</b></p>
                                <p style="font-weight:bold">Độc lập – Tự do – Hạnh Phúc</p>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2"></td>
                            <td colspan="2" align="center">
                                -----------o0o------------
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2"></td>
                            <td colspan="2" align="center">
                                ........., ngày .....&nbsp;tháng.....&nbsp;năm.....
                            </td>
                        </tr>
                    </table>
                    <table class="table sticky-table" >
                        <thead>
                            <tr>
                                <td colspan="4" align="center"><p style="font-size:28px"><b>BÁO CÁO TIÊU THỤ ĐIỆN</b></p></td>
                            </tr>
                            <tr>
                                <td colspan="4" align="center"><span>Từ ngày:</span>&nbsp;<span><%= start_date %> </span>&nbsp;&nbsp;<span>Đến ngày:</span>&nbsp;<span><%= end_date %> </span></td>
                            </tr>
                            <tr>
                                <td colspan="4" align="center"><span>Họ và Tên:</span><span>....................... </span><span>Chức vụ:</span><span>............. </span><span>Bộ phận công tác:</span><span>............. </span></td>
                            </tr>
                        </thead>
                        <thead>
                            <tr>
                                <th style="background-color:deepskyblue;color:white;width:5em;border:thin solid white">STT</th>
                                <th style="background-color:deepskyblue;color:white;width:10em;border:thin solid white">Thời gian</th>
                                <th style="background-color:deepskyblue;color:white;width:8em;border:thin solid white">Tiêu thụ</th>
                                <th style="background-color:deepskyblue;color:white;width:9em;border:thin solid white">Ghi chú</th>
                            </tr>
                        </thead>
                        <tbody>
                      
                        
                            <% for(let i=0; i<power87.length; i++){ %>
                            <tr>
                                <td class="text-center" style="border:thin solid black;text-align:center;width:5em"><p style="width:9em;white-space:nowrap;overflow:hidden"> <%= i+1 %></p></td>
                                <td class="text-center" style="border:thin solid black;text-align:center;width:10em"><p style="width:9em;white-space:nowrap;overflow:hidden"> <%= power87[i].Time %></p></td>
                                <td class="text-center" style="border:thin solid black;text-align:center;width:8em"><p style="width:9em;white-space:nowrap;overflow:hidden"> <%= power87[i].powerH %></p></td>
                                <td class="text-center" style="border:thin solid black;text-align:center;width:8em"><p style="width:9em;white-space:nowrap;overflow:hidden"> </p></td>
                            </tr>
                          
                            <% } %>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td class="text-center" colspan="2" style="border:thin solid black;text-align:center;width:9em"><p style="width:9em;white-space:nowrap;overflow:hidden"> Tổng số</p></td>
                                <% var plantRateSum = 0;  %>
                                <% for(let i=0; i<power87.length; i++){ %>
                                    <% plantRateSum +=  power87[i].powerH %> 
                                    <% } %>
                                <td class="text-center" style="border:thin solid black;text-align:center;width:9em"><p style="width:9em;white-space:nowrap;overflow:hidden"> <%= plantRateSum %></p></td>
                                
                            </tr>
                        </tfoot>
                    </table>
                </div>
                <div class="data-table" id="LVMSB2" data-SheetName="LVMSB2" style="display:none">
                    <table style="border:0;" cellpadding="10" cellspacing="10">
                        <tr>
                            <td colspan="2" align="center">
                                <p style="font-size:18px"><b>Sumirubber Vietnam</b></p>
                                <p> -----------o0o------------</p>
                            </td>
                            <td colspan="2" align="center">
                                <p style="font-size:18px"><b>CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM</b></p>
                                <p style="font-weight:bold">Độc lập – Tự do – Hạnh Phúc</p>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2"></td>
                            <td colspan="2" align="center">
                                -----------o0o------------
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2"></td>
                            <td colspan="2" align="center">
                                ........., ngày .....&nbsp;tháng.....&nbsp;năm.....
                            </td>
                        </tr>
                    </table>
                    <table class="table sticky-table" >
                        <thead>
                            <tr>
                                <td colspan="4" align="center"><p style="font-size:28px"><b>BÁO CÁO TIÊU THỤ ĐIỆN</b></p></td>
                            </tr>
                            <tr>
                                <td colspan="4" align="center"><span>Từ ngày:</span>&nbsp;<span><%= start_date %> </span>&nbsp;&nbsp;<span>Đến ngày:</span>&nbsp;<span><%= end_date %> </span></td>
                            </tr>
                            <tr>
                                <td colspan="4" align="center"><span>Họ và Tên:</span><span>....................... </span><span>Chức vụ:</span><span>............. </span><span>Bộ phận công tác:</span><span>............. </span></td>
                            </tr>
                        </thead>
                        <thead>
                            <tr>
                                <th style="background-color:deepskyblue;color:white;width:5em;border:thin solid white">STT</th>
                                <th style="background-color:deepskyblue;color:white;width:10em;border:thin solid white">Thời gian</th>
                                <th style="background-color:deepskyblue;color:white;width:8em;border:thin solid white">Tiêu thụ</th>
                                <th style="background-color:deepskyblue;color:white;width:9em;border:thin solid white">Ghi chú</th>
                            </tr>
                        </thead>
                        <tbody>
                      
                        
                            <% for(let i=0; i<power972.length; i++){ %>
                            <tr>
                                <td class="text-center" style="border:thin solid black;text-align:center;width:5em"><p style="width:9em;white-space:nowrap;overflow:hidden"> <%= i+1 %></p></td>
                                <td class="text-center" style="border:thin solid black;text-align:center;width:10em"><p style="width:9em;white-space:nowrap;overflow:hidden"> <%= power972[i].Time %></p></td>
                                <td class="text-center" style="border:thin solid black;text-align:center;width:8em"><p style="width:9em;white-space:nowrap;overflow:hidden"> <%= power972[i].powerH %></p></td>
                                <td class="text-center" style="border:thin solid black;text-align:center;width:8em"><p style="width:9em;white-space:nowrap;overflow:hidden"> </p></td>
                            </tr>
                          
                            <% } %>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td class="text-center" colspan="2" style="border:thin solid black;text-align:center;width:9em"><p style="width:9em;white-space:nowrap;overflow:hidden"> Tổng số</p></td>
                                <% var plantRateSum = 0;  %>
                                <% for(let i=0; i<power972.length; i++){ %>
                                    <% plantRateSum +=  power972[i].powerH %> 
                                    <% } %>
                                <td class="text-center" style="border:thin solid black;text-align:center;width:9em"><p style="width:9em;white-space:nowrap;overflow:hidden"> <%= plantRateSum %></p></td>
                                
                            </tr>
                        </tfoot>
                    </table>
                </div>

                <div class="data-table" id="LVMSB3" data-SheetName="LVMSB3" style="display:none">
                    <table style="border:0;" cellpadding="10" cellspacing="10">
                        <tr>
                            <td colspan="2" align="center">
                                <p style="font-size:18px"><b>Sumirubber Vietnam</b></p>
                                <p> -----------o0o------------</p>
                            </td>
                            <td colspan="2" align="center">
                                <p style="font-size:18px"><b>CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM</b></p>
                                <p style="font-weight:bold">Độc lập – Tự do – Hạnh Phúc</p>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2"></td>
                            <td colspan="2" align="center">
                                -----------o0o------------
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2"></td>
                            <td colspan="2" align="center">
                                ........., ngày .....&nbsp;tháng.....&nbsp;năm.....
                            </td>
                        </tr>
                    </table>
                    <table class="table sticky-table" >
                        <thead>
                            <tr>
                                <td colspan="4" align="center"><p style="font-size:28px"><b>BÁO CÁO TIÊU THỤ ĐIỆN</b></p></td>
                            </tr>
                            <tr>
                                <td colspan="4" align="center"><span>Từ ngày:</span>&nbsp;<span><%= start_date %> </span>&nbsp;&nbsp;<span>Đến ngày:</span>&nbsp;<span><%= end_date %> </span></td>
                            </tr>
                            <tr>
                                <td colspan="4" align="center"><span>Họ và Tên:</span><span>....................... </span><span>Chức vụ:</span><span>............. </span><span>Bộ phận công tác:</span><span>............. </span></td>
                            </tr>
                        </thead>
                        <thead>
                            <tr>
                                <th style="background-color:deepskyblue;color:white;width:5em;border:thin solid white">STT</th>
                                <th style="background-color:deepskyblue;color:white;width:10em;border:thin solid white">Thời gian</th>
                                <th style="background-color:deepskyblue;color:white;width:8em;border:thin solid white">Tiêu thụ</th>
                                <th style="background-color:deepskyblue;color:white;width:9em;border:thin solid white">Ghi chú</th>
                            </tr>
                        </thead>
                        <tbody>
                      
                        
                            <% for(let i=0; i<powerDH.length; i++){ %>
                            <tr>
                                <td class="text-center" style="border:thin solid black;text-align:center;width:5em"><p style="width:9em;white-space:nowrap;overflow:hidden"> <%= i+1 %></p></td>
                                <td class="text-center" style="border:thin solid black;text-align:center;width:10em"><p style="width:9em;white-space:nowrap;overflow:hidden"> <%= powerDH[i].Time %></p></td>
                                <td class="text-center" style="border:thin solid black;text-align:center;width:8em"><p style="width:9em;white-space:nowrap;overflow:hidden"> <%= powerDH[i].powerH %></p></td>
                                <td class="text-center" style="border:thin solid black;text-align:center;width:8em"><p style="width:9em;white-space:nowrap;overflow:hidden"> </p></td>
                            </tr>
                          
                            <% } %>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td class="text-center" colspan="2" style="border:thin solid black;text-align:center;width:9em"><p style="width:9em;white-space:nowrap;overflow:hidden"> Tổng số</p></td>
                                <% var plantRateSum = 0;  %>
                                <% for(let i=0; i<powerDH.length; i++){ %>
                                    <% plantRateSum +=  powerDH[i].powerH %> 
                                    <% } %>
                                <td class="text-center" style="border:thin solid black;text-align:center;width:9em"><p style="width:9em;white-space:nowrap;overflow:hidden"> <%= plantRateSum %></p></td>
                                
                            </tr>
                        </tfoot>
                    </table>
                </div>
             
                </div>
            
            </div>
        </div>
    </div>
</div>




<style>
    .export-excel {
    min-width: 310px;
    max-width: 800px;
    margin: 1em auto;
}
    .layout-datetime {
        display: inline-block;
        width:100%;
    }
    .title-datetime {
        text-align: center;
       
    }
    .title-datetime .date-time {
        display: inline-block;
        padding: 10px;
        background: linear-gradient(90deg, rgba(181,34,101,0.8995973389355743) 0%, rgba(27,231,143,0.5970763305322129) 0%, rgba(45,196,208,0.9640231092436975) 100%);
        color: white;
    }
    .highcharts-figure, .highcharts-data-table table {
    min-width: 310px; 
    max-width: 800px;
    margin: 1em auto;
}

#container {
    height: 400px;
}

.highcharts-data-table table {
	font-family: Verdana, sans-serif;
	border-collapse: collapse;
	border: 1px solid #EBEBEB;
	margin: 10px auto;
	text-align: center;
	width: 100%;
	max-width: 500px;
}
.highcharts-data-table caption {
    padding: 1em 0;
    font-size: 1.2em;
    color: #555;
}
.highcharts-data-table th {
	font-weight: 600;
    padding: 0.5em;
}
.highcharts-data-table td, .highcharts-data-table th, .highcharts-data-table caption {
    padding: 0.5em;
}
.highcharts-data-table thead tr, .highcharts-data-table tr:nth-child(even) {
    background: #f8f8f8;
}
.highcharts-data-table tr:hover {
    background: #f1f7ff;
}
.highcharts-container {
  width:auto !important;
  height:auto !important;
}
svg.highcharts-root {
width:auto !important;
  height:auto !important;
}
</style>

<script>
        var tablesToExcelMultiTabs = (function ($) {
        var uri = 'data:application/vnd.ms-excel;base64,'
        , html_start = `<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">`
        , template_ExcelWorksheet = `<x:ExcelWorksheet><x:Name>{SheetName}</x:Name><x:WorksheetSource HRef="sheet{SheetIndex}.htm"/></x:ExcelWorksheet>`
        , template_ListWorksheet = `<o:File HRef="sheet{SheetIndex}.htm"/>`
        , template_HTMLWorksheet = `
------=_NextPart_dummy
Content-Location: sheet{SheetIndex}.htm
Content-Type: text/html; charset=windows-1252

` + html_start + `
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <link id="Main-File" rel="Main-File" href="../WorkBook.htm">
  <link rel="File-List" href="filelist.xml">
</head>
<body><table>{SheetContent}</table></body>
</html>`
        , template_WorkBook = `MIME-Version: 1.0
X-Document-Type: Workbook
Content-Type: multipart/related; boundary="----=_NextPart_dummy"

------=_NextPart_dummy
Content-Location: WorkBook.htm
Content-Type: text/html; charset=windows-1252

` + html_start + `
<head>
<meta name="Excel Workbook Frameset">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="File-List" href="filelist.xml">
<!--[if gte mso 9]><xml>
 <x:ExcelWorkbook>
  <x:ExcelWorksheets>{ExcelWorksheets}</x:ExcelWorksheets>
  <x:ActiveSheet>1</x:ActiveSheet>
 </x:ExcelWorkbook>
</xml><![endif]-->
</head>
<frameset>
  <frame src="sheet0.htm" name="frSheet">
  <noframes><body><p>This page uses frames, but your browser does not support them.</p></body></noframes>
</frameset>
</html>
{HTMLWorksheets}
Content-Location: filelist.xml
Content-Type: text/xml; charset="utf-8"

<xml xmlns:o="urn:schemas-microsoft-com:office:office">
  <o:MainFile HRef="../WorkBook.htm"/>
  {ListWorksheets}
  <o:File HRef="filelist.xml"/>
</xml>
------=_NextPart_dummy--
`
        , base64 = function (s) { return window.btoa(unescape(encodeURIComponent(s))) }
        , format = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }
        return function (tables, filename) {
            var context_WorkBook = {
                ExcelWorksheets: ''
            , HTMLWorksheets: ''
            , ListWorksheets: ''
            };
            var tables = jQuery(tables);
            var dt = new Date();
            var day = dt.getDate();
            var month = dt.getMonth() + 1;
            var year = dt.getFullYear();
            var hour = dt.getHours();
            var mins = dt.getMinutes();
            var postfix = day + "." + month + "." + year + "_" + hour + "." + mins;
            $.each(tables, function (SheetIndex) {
                var $table = $('#' + tables[SheetIndex]);

                var SheetName = $table.attr('data-SheetName');
                if ($.trim(SheetName) === '') {
                    SheetName = 'Sheet' + SheetIndex;
                }
                context_WorkBook.ExcelWorksheets += format(template_ExcelWorksheet, {
                    SheetIndex: SheetIndex
                , SheetName: SheetName
                });
                context_WorkBook.HTMLWorksheets += format(template_HTMLWorksheet, {
                    SheetIndex: SheetIndex
                , SheetContent: $table.html()
                });
                context_WorkBook.ListWorksheets += format(template_ListWorksheet, {
                    SheetIndex: SheetIndex
                });
            });

            var link = document.createElement("A");
            link.href = uri + base64(format(template_WorkBook, context_WorkBook));
            link.download = "ReportChart" + postfix + ".xls";
            link.target = '_blank';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    })(jQuery);
</script>
<!-- Bieu do 1 -->
<script>
    Highcharts.chart('powerHour87', {
          chart: {
            backgroundColor:'rgba(255, 255, 255, 0.9)',
              type: 'line',
              zoomType: 'x'
          },
          title: {
              text: 'LVMSB1 - <%= title %>',
              style: {
                  color: "#fff"
               }
          },
          xAxis: {
            categories: [
            <% for(let i=0; i<power87.length; i+=30){ %>
            '<%= power87[i].Time %>',
            <% } %>
            ]
          },
          yAxis: {
              title: {
                  text: 'kWh'
              },
            
          },
          series: [{
              name: 'LVMSB1',
              data: [
                <% for(let i=0; i<power87.length; i+=30){ %>
                    <%= power87[i].powerH %>,
                <% } %>
                ],
                color:'#66ccff'
                }],
        
      
      
      });
</script>

<!-- Bieu do 2 -->
<script>
    Highcharts.chart('powerHour972', {
          chart: {
            backgroundColor:'rgba(255, 255, 255, 0.9)',
              type: 'line',
              zoomType: 'x'
          },
          title: {
              text: 'LVMSB2 - <%= title %>',
              style: {
                  color: "#fff"
               }
          },
          xAxis: {
            categories: [
            <% for(let i=0; i<power972.length; i+=30){ %>
            '<%= power972[i].Time %>',
            <% } %>
            ]
          },
          yAxis: {
              title: {
                  text: 'kWh'
              },
            
          },
          series: [{
              name: 'LVMSB2',
              data: [
                <% for(let i=0; i<power972.length; i+=50){ %>
                    <%= power972[i].powerH %>,
                <% } %>
                ],
                color:'#ff3333'
                }],
        
      
      
      });
</script>

<!-- Bieu do 3 -->
<script>
    Highcharts.chart('powerHourDh', {
          chart: {
            backgroundColor:'rgba(255, 255, 255, 0.9)',
              type: 'line',
              zoomType: 'x'
          },
          title: {
              text: 'LVMSB3 - <%= title %>',
              style: {
                  color: "#fff"
               }
          },
          xAxis: {
            categories: [
            <% for(let i=0; i<powerDH.length; i+=50){ %>
            '<%= powerDH[i].Time %>',
            <% } %>
            ]
          },
          yAxis: {
              title: {
                  text: 'kWh'
              },
            
          },
          series: [{
              name: 'LVMSB3',
              data: [
                <% for(let i=0; i<powerDH.length; i+=50){ %>
                    <%= powerDH[i].powerH %>,
                <% } %>
                ],
                color:'#70db70'
                }],
        
      
      
      });
</script>



